local originalFunction = {
    RunScript = RunScript,
    SlashCmdList = SlashCmdList,
    SendMailMailButton = SendMailMailButton,
    SendMailMoneyGold = SendMailMoneyGold,
    ChatFrame1 = ChatFrame1,
    DEFAULT_CHAT_FRAME = DEFAULT_CHAT_FRAME,
    RemoveExtraSpaces = RemoveExtraSpaces,
    Click = Click,
}

local ticker

local function DetectMalware()
    local modified = false

    if originalFunction.RunScript ~= RunScript then
        print("AntiMalware: RunScript function has been modified, this may harm your game!")
        modified = true
    end

    if originalFunction.SlashCmdList ~= SlashCmdList then
        print("AntiMalware: SlashCmdList function has been modified, this may harm your game!")
        modified = true
    end

    if originalFunction.SendMailMailButton ~= SendMailMailButton then
        print("AntiMalware: SendMailMailButton function has been modified, this may harm your game!")
        modified = true
    end

    if originalFunction.SendMailMoneyGold ~= SendMailMoneyGold then
        print("AntiMalware: SendMailMoneyGold function has been modified, this may harm your game!")
        modified = true
    end

    if originalFunction.ChatFrame1 ~= ChatFrame1 then
        print("AntiMalware: ChatFrame1 function has been modified, this may harm your game!")
        modified = true
    end

    if originalFunction.DEFAULT_CHAT_FRAME ~= DEFAULT_CHAT_FRAME then
        print("AntiMalware: DEFAULT_CHAT_FRAME function has been modified, this may harm your game!")
        modified = true
    end

    if originalFunction.RemoveExtraSpaces ~= RemoveExtraSpaces then
        print("AntiMalware: RemoveExtraSpaces function  has been modified, this may harm your game!")
        modified = true
    end

    if originalFunction.Click ~= Click then
        print("AntiMalware: Click function has been modified, this may harm your game!")
        modified = true
    end

    return modified
end

local function StartScan()
    if DetectMalware() then
        ticker:Cancel()
    end
end

ticker = C_Timer.NewTicker(30, StartScan, 10800)